---
title: 计算机组成原理 第三章 存储系统
date: 2025-03-01 15:25:40
category: 计算机组成原理
tags:
  - 计算机组成原理
  - 笔记
description: 计算机省钱原理。
cover: https://bu.dusays.com/2025/03/02/67c3f67d3090a.jpg
series: CS
---

> **🚥计算机组成原理 系列文章导航🚥**
>
> {% series CS %}
>

## 一、存储系统概述

### 1.存储器的分类

**（1）按存储元件分类**

存储元件必须有两个截然不同的物理状态才能被用来表示二级制代码 0 和 1。常用的存储有元件有半导体器件、磁性材料和光介质。用这些材料制成的存储器分别称为**半导体存储器**、**磁表面存储器**、**光盘存储器**。

**（2）按存取方式分类**

- **随机存取存储器（Random Access Memory，RAM）**：读写任何一个存储单元所需时间都相同，与存储单元所在的物理位置无关。
- **顺序存取存储器（Sequential Access Memory，SAM）**：读写一个存储单元所需时间取决于存储单元所在的物理位置（如磁带）。
- **直接存取存储器（Direct Access Memory，DAM）**：既有随机存取特性，也有顺序存取特性。先直接选取信息所在区域，然后按顺序方式存取，存取速度位于 RAM 和 DAM 之间（如磁盘、光盘）。

SAM 和 DAM 读写某个存储单元所需时间都与存储单元的物理位置有关，两者统称为**串行访问存储器**。

上述的三种存储器都是按所需信息的地址来访问，但有时我们只知道要访问信息的内容特征，此时，只能按内容检索到存储位置进行读写，这种存储器成为**按内容访问存储器（Content Addressed Memory，CAM）**或**相联存储器（Associative Memory）**。快表就是一种相联存储器。

**（3）按信息的可更改性分类**

- **读写存储器（Read/Write Memory）**：可读、也可写（如 RAM 芯片）。
- **只读存储器（Read Only Memory）**：只能读，不能写（用 ROM 表示，BIOS 通常写在 ROM 中）。

> **注意**：RAM 芯片和 ROM 芯片都采用随机存取方式进行信息的访问。ROM 芯片中的信息一旦确定，通常情况下只读不写，但广义上的只读存储器已可通过电擦除等方式进行写入，“只读” 的概念没有保留，但仍保留了断电内容保留、随机读取特性，但其写入速度比读取速度慢得多。

**（4）按断电后信息的可保存性分类**

- **易失性存储器（Volatile Memory）**：电源关闭时信息自动丢失（如 RAM、Cache）。
- **非易失性存储器（Nonvolatile Memory）**：信息可一直保留，不需电源维持（如 ROM、磁表面存储器、光存储器）。

**（5）按功能分类**

- **高速缓冲存储器**：简称 Cache，位于主存和 CPU 之间，用来存放当前 CPU 经常使用的指令和数据。
- **主存储器**：简称主存，也称内存储器（内存），用来存放计算机运行期间所需的程序和数据，CPU 可以直接随机地对其进行访问。主存也可和 Cache 及辅助存储器交换数据。
- **辅助存储器**：简称辅存，也称外存储器（外存），用来存放当前暂时不用的程序和数据，以及一些需要永久保存的信息。辅存的内容需要调入主存后才能被 CPU 访问。

> **注意**：也有些地方将辅存与外存区分开，辅存指磁盘存储器，外存指辅存和容量更大，速度更慢的磁带存储器和光盘存储器。

### 2.存储器的性能指标

**（1）存储容量 = 存储字数 × 字长（如 1M × 8 位）**

存储字数表示存储器的地址空间大小，字长表示一次存取操作的数据量。

**（2）单位成本：价位 = 总成本/总容量**

**（3）存储速度：数据传输速率（每秒传送信息的位数）= 数据的宽度/存取周期**

- **存取时间（T_a）**：指从启动一次存储器操作到完成该操作所经历的时间，分为读出时间和写入时间。
- **存取周期（T_m）**：存取周期是指存储器进行一次完整的读/写操作所需要的全部时间，即连续两次独立访问存储器操作之间所需的最小时间间隔。
- **主存带宽（B_m）**：也称**数据传输速率**，表示每秒从主存进出信息的最大数量，单位为字/秒、字节/秒（B/s）或位/秒（b/s）。

存取周期大于存储时间，因为任何一种存储器在进行读写操作后都需要一段恢复内部状态的复原时间。

![image-20250302161115319](https://bu.dusays.com/2025/03/02/67c412bfdcc2c.png)

### 3.存储器的层次结构

![image-20250302161316835](https://bu.dusays.com/2025/03/02/67c413efaf884.png)

![image-20250302161351639](https://bu.dusays.com/2025/03/02/67c413f34af08.png)

存储器层次结构的主要思想是上一层的存储器作为低一层存储器的高速缓存。

**Cache-主存层**主要解决 CPU 和主存速度不匹配的问题，主存和 Cache 之间的数据调动是由**硬件**自动完成的，对所有程序员均是透明的。

**主存-辅存层**主要解决存储系统的容量问题，主存和辅存之间的数据调动是由**硬件和操作系统**共同完成的，对应用程序员是透明的（此处的透明均为看不见的意思）。

## 二、主存储器

### 1.主存储器的基本组成

下图为一个单管动态 MOS 管存储元件，MOS 管用于控制电路的通断，电容存在有电和没电两种状态，可用于表示 0 和 1 两种二进制代码。

![image-20250302201451157](https://bu.dusays.com/2025/03/02/67c452afce0cb.png)

像这样一个个存储 0 或 1 的记忆单元（也称存储元件、存储单元）构成的存储矩阵（也称存储体、存储阵列），是存储器的核心部件。

![image-20250302201809178](https://bu.dusays.com/2025/03/02/67c452b391df3.png)

图中一行存储元件构成一个存储单元，地址线每次控制访存一整个存储单元的内容。也就是说，每次同时访存一整个字。而片选线用于选择要交互的芯片。

封装后的主存如下图所示：

![image-20250302202307029](https://bu.dusays.com/2025/03/02/67c452b6ddc76.png)

当需要访问主存时，CPU 首先把被访问单元的地址送到 MAR 中，然后通过地址线将主存地址送到主存中的地址寄存器，以便地址译码器进行译码，选中相应单元，同时 CPU 将读/写控制信号通过读/写控制线送到主存的读写控制电路。根据选择的不同，通过数据线将数据从存储体送进 MDR（读）或从 MDR 送进存储体（写）。

MAR 的位数与地址线的位数相同，MDR 的位数与数据线的位数相同。

以 64K × 32 位的芯片为例，我们可以计算出地址线和数据线的位数分别为 16 和 32（这里默认按字寻址，根据寻址方式的不同，地址线的个数也会不一样，例如如果按字节寻址，则地址线的个数应为 18，可表示的地址范围要扩大四倍）。

> **注意**：数据线的位数通常等于存储字长，因此 MDR 的位数通常等于存储字长；若数据线的位数不等于存储字长，则 MDR 的位数由数据线的位数决定。

### 2.SRAM 和 DRAM

#### （1）存储元特性差异

半导体分为随机存储器（RAM）和只读存储器（ROM）。RAM 又分为**动态随机存储器（Dynamic Random Access Memory，DRAM）**和**静态随机存储器（Static Random Access Memory，SRAM）**。

上面我们刚刚讲到的单 MOS 管存储元使用栅极电容来存储信息，除此之外还可以用由 6 个 MOS 管组成的双稳态触发器来存储信息，它有 A 高 B 低和 A 低 B 高两种稳定的状态来表示二进制代码。

![image-20250303145843314](https://bu.dusays.com/2025/03/03/67c587e775c48.png)

**DRAM 芯片**：采用栅极电容存储信息，成本低，功耗低，集成度高，但由于是破坏性读出，读出后需要有重新操作，因此存取速度慢。

**SRAM 芯片**：采用双稳态触发器存储信息，成本高，功耗高，集成度低，为非破坏性读出，读出后不需要重新，因此存取速度快。

主存储器主要都是由 DRAM 实现，而靠近处理器的那一层（Cache）则由 SRAM 实现。

#### （2）DRAM 的刷新

栅极电容上的电荷一般只能维持 1 到 2 ms，即使电源不断电，信息也会自动消失，因此需要定时刷新。而双稳态触发器只要持续供电，存储的信息就不会消失。

对于 DRAM 芯片的刷新采用读出的方式进行，根据读出内容对相应单元进行重写，即**读后再生**，对同一行进行相邻两次刷新的时间间隔称为刷新周期，通常取 **2ms**。

DMA 的刷新单位是行。那么，什么是行呢？

为了减少与地址译码器相连的选通线的数量，一般将存储单元的地址拆分为二维的行列地址。对于以 8 位地址为例，如果采用一维地址，则需要有 2^8 = 256 根选通线与译码器相连，而如果采用二维地址，则只需要 2^4 + 2^4 = 32 根选通线。

![image-20250303154446294](https://bu.dusays.com/2025/03/03/67c587ed9f061.png)

> **注意**：DRAM 芯片容量较大，地址位数较多，为了减少芯片的地址引脚数，通常采用**地址引脚复用技术**，行地址和列地址通过相同的引脚分先后两次输入，这样地址引脚数可减少一半（SRAM 则不采用这种复用技术，而是同时送入行列地址）。

> **注意**：对于一个 2^n × b 位 DRAM 芯片的存储阵列，其行数为 r，列数为 c，则 2^n = r × c。由于 DRAM 采用地址引脚复用技术，为减少地址引脚数，应尽量使行、列位数相同。又因为 DRAM 按行刷新，为减少刷新开销，应使行数较小，即当行列无法相同时，行数应为较小的哪个数。

常用的刷新方式有以下三种：

![image-20250303163219705](https://bu.dusays.com/2025/03/03/67c587f201aaa.png)

**集中刷新**：在整个刷新间隔内，前一段时间用于正常的读写操作，后一段时间停止读写操作，集中逐行进行刷新。在此期间停止对存储器的读/写操作，称为死时间，也称访存死区。

优点是读/写操作期间不受刷新操作的影响；缺点是集中刷新期间不能访问存储器。

![image-20250303163241298](https://bu.dusays.com/2025/03/03/67c587f559228.png)

**分散刷新**：将存储器系统的工作周期分为两部分，前半部分用于正常的读写操作，后半部分用于刷新。这种方式增加了系统的存取周期，如存储芯片的存取周期为 0.5us，刷新所需时间为 0.5us，则系统的存取周期为 1us。

优点是没有死区；缺点是加长了系统的存取时间。

> **注意**：分散刷新的刷新操作是独立于读写操作的，不是只刷新被读写的行，而是按照固定顺序依次刷新，并且无论是否有读写请求，控制器都会在每个周期的后半段执行刷新，确保在 2ms 内覆盖全部存储单元。

![image-20250303182345467](https://bu.dusays.com/2025/03/03/67c587f8b9fb9.png)

**异步刷新**：结合前两种方式，2ms 内每行刷新一次即可。如存取周期为 0.5us，排列成 128 × 128 的存储芯片，可采取在 2ms 内对 128 行各刷新一遍，即每隔 2000us ÷ 128 = 15.6us 刷新一行。若每行刷新的时间为 0.5us，则对每行来说，刷新时间仍为 2ms，但死时间缩短为 0.5us。

通过这种方式使死时间的分布更加分散，避免让 CPU 连续等待过长的时间。

#### （3）DRAM 芯片的行缓冲器

DRAM 芯片内部有一个**行缓冲器**，用来缓存指定行中每列的数据，其大小为 列数 × 存储元的位数，常用 **SRAM** 实现。

选中某行后，该行的所有数据都被送到行缓冲器，以后每个时钟都可以连续地从 DRAM 中输出一个数据，因此可支持**突发传输**（突发传输方式是指在寻址阶段给出数据的首地址，在传输阶段可传送多个连续存储单元的数据）。

#### （4）SRAM 和 DRAM 的比较

|    特点    |     SRAM     |       DRAM       |
| :--------: | :----------: | :--------------: |
|  存储信息  | 双稳态触发器 |     栅极电容     |
| 破坏性读出 |      非      |        是        |
|  需要刷新  |     不要     |        要        |
| 送行列地址 |    同时送    | 分两次送（复用） |
|  运行速度  |      快      |        慢        |
|   集成度   |      低      |        高        |
|  存储成本  |      高      |        低        |
|  主要用途  |   高速缓存   |     主机内存     |

**SDRAM芯片技术**

目前主存常用的是基于 **SDRAM（Synchronous DRAM，同步动态随机存储器）** 芯片技术的内存条。与传统的异步 DRAM 不同，SDRAM 与 CPU 的数据交换同步于系统的时钟信号，并且以 CPU-主存总线的最高速度运行，而不需要插入等待状态。

在传统 DRAM 中，CPU 将地址和控制信号送至存储器后，需经过一段延迟时间，数据才读出或写入。在此期间，CPU不断采样 DRAM 的完成信号，在读写完成之前，CPU 不能做其他工作，降低了 CPU 的执行速度。而 SDRAM 在系统时钟的控制下进行数据的读出和写入，它将 CPU 发出的地址和控制信号封锁起来，经过指定的时钟周期数后再响应，此时 CPU 可执行其他操作。

### 3.只读存储器 ROM

ROM 芯片具有两个显著的优点：结构简单，所以位密度比可读/写存储器的高；具有非易失性，所以可靠性高。

根据制造工艺的不同，ROM 可分为以下几种：

**（1）MROM（Mask Read-Only Memory）—— 掩模式只读存储器**

厂家按照客户需求，在芯片生产过程中直接写入信息，之后任何人**不可**重写。可靠性高、灵活性差、生产周期长、只适合批量定制。

**（2）PROM（Programmable Read-Only Memory）—— 可编程只读存储器**

用户可用于专门的 PROM 写入器写入信息，写**一次**之后就不可更改。

**（3）EPROM（Erasable Programmable Read-Only Memory ）—— 可擦除可编程只读存储器**

允许用户写入信息，之后通过某种方式擦除数据，可进行**多次**重写。

- **UVEPROM（Ultra Violet EPROM）**：用紫外线照射一段时间，擦除**所有信息**。
- **EEPROM（Electrically EPROM）**：可用 “电擦除” 的方式，擦除**特定的字**。 

> **注意**：虽然 EPROM 可读可写，但它不能取代 RAM，因为 EPROM 的编程次数有限，且写入时间过长。

**（4）Flash Memory —— 闪速存储器**

Flash 存储器是在 EPROM 的基础上发展起来的，它兼有 ROM 和 RAM 的特优点，可在不加电的情况下长期保存信息，又能在线进行快速擦除重写。

Flash 存储器既有 EPROM 价格便宜、集成度高的优点，又有 EEPROM 电可擦除重写的特点，且擦除重写的速度快。

U 盘、SD 卡就是 Flash 存储器，由于其需要先擦除再写入，因此 Flash 存储器的写速度要比读速度慢。

Flash 存储器的每个存储元只需单个 MOS 管（无需电容），位密度比 RAM 更高。

**（5）SSD（Solid State Drive）—— 固态硬盘**

基于闪存的固态硬盘由**控制单元和存储单元（Flash 芯片）** 组成。保留了 Flash 存储器长期保存信息、快速擦除与重写的特点，对比传统硬盘也有读/写速度快、低功耗的特点，缺点是价格较高。

> **计算机内的重要 ROM**
>
> 主板上的 BIOS 芯片（ROM）存储了 “自举装入程序”，负责引导装入操作系统（开机）。虽然 BIOS 芯片位于主板上，但从逻辑上讲，主存是由 RAM + ROM 构成的，且二者常常统一编址。因此主板上的 ROM 芯片也是主存的一部分。











